from detector.test import test_model
from detector.train import train_model

# 使用全0噪音向量训了得到的黑盒检测器(144维):
# 0.91左右,拟合较好
invariant_noise_model1_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/invariant_noise/resnet18_epoch20.pth"
# 0.87左右,过拟合
invariant_noise_model2_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/invariant_noise/resnet18_epoch30.pth"
# 0.78左右,尚未完全拟合
invariant_noise_model3_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/invariant_noise/resnet18_epoch15.pth"
# 0.75左右,过拟合?
invariant_noise_model4_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/invariant_noise/resnet18_epoch25.pth"

# 使用随机噪音向量训练得到的黑盒检测器(144维):
# best在80%
random_noise_model1_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/random_noise/resnet18_epoch20_best.pth"
# 75.5%左右
random_noise_model2_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/random_noise/resnet18_epoch22.pth"
# 75.5%左右
random_noise_model3_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/random_noise/resnet18_epoch30_best.pth"
# best 90.51%
random_noise_model4_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/random_noise/resnet18_epoch18_best.pth"
# 75.5%左右
random_noise_model5_resnet18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/random_noise/resnet18_epoch17_best.pth"

# 75.5%左右
random_noise_model1_resnet50_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/random_noise/resnet50_epoch20_best.pth"
# 75.5%左右
random_noise_model2_resnet50_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/random_noise/resnet50_epoch22.pth"
# best在90.29%左右
random_noise_model3_resnet50_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/144 dimension/random_noise/resnet50_epoch18_best.pth"

# 黑盒检测器(128维):
# best:88%
model1_resnet18_epoch20_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/128 dimension/resnet18_epoch20_best.pth"
# best 94.7%
model2_resnet18_epoch18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/128 dimension/resnet18_epoch18_best.pth"
# 75.5%
model3_resnet18_epoch22_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/128 dimension/resnet18_epoch22_best.pth"


train_benign_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_ben.bmp/train'
train_malignant_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_mal.bmp/train'
test_benign_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_ben.bmp/test'
test_malignant_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_mal.bmp/test'

if __name__ == "__main__":
    # 训练模型:
    #train_model(model3_resnet18_epoch22_path, 22, train_benign_path, train_malignant_path, test_benign_path,test_malignant_path)
    # 测试模型
    test_model(model3_resnet18_epoch22_path, test_benign_path, test_malignant_path)
