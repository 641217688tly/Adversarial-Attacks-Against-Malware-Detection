from detector.test import test_model
from detector.train import train_model

train_benign_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_ben.bmp/train'
train_malignant_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_mal.bmp/train'
test_benign_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_ben.bmp/test'
test_malignant_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_mal.bmp/test'
# 0.91左右,拟合较好
model_path1 = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/resnet18_epoch20.pth"
# 0.87左右,过拟合
model_path2 = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/resnet18_epoch30.pth"
# 0.78左右,尚未完全拟合
model_path3 = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/resnet18_epoch15.pth"
# 0.75左右,过拟合?
model_path4 = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/model/resnet18_epoch25_best.pth"

if __name__ == "__main__":
    # 训练模型:
    # train_model(model_path4, 25, train_benign_path, train_malignant_path, test_benign_path, test_malignant_path)
    # 测试模型
    test_model(model_path1, test_benign_path, test_malignant_path)
