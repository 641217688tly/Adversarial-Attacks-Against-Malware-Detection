from detector import load_config
from detector.test import test_model
from detector.train import train_model

# 加载配置信息
config = load_config('../config.yml')

TRAIN_BENIGN_BMP_DATASET_PATH = config['DETECTOR']['DATASET']['TRAIN_BENIGN_BMP_DATASET_PATH']
TRAIN_MALWARE_BMP_DATASET_PATH = config['DETECTOR']['DATASET']['TRAIN_MALWARE_BMP_DATASET_PATH']
TEST_BENIGN_BMP_DATASET_PATH = config['DETECTOR']['DATASET']['TEST_BENIGN_BMP_DATASET_PATH']
TEST_MALWARE_BMP_DATASET_PATH = config['DETECTOR']['DATASET']['TEST_MALWARE_BMP_DATASET_PATH']
# 黑盒检测器(128维):
RESNET_MODEL_PATH = config['DETECTOR']['MODEL']['RESNET_MODEL_PATH']

if __name__ == "__main__":
    # 训练模型:
    #train_model(RESNET_MODEL_PATH, 18, TRAIN_BENIGN_BMP_DATASET_PATH, TRAIN_MALWARE_BMP_DATASET_PATH,TEST_BENIGN_BMP_DATASET_PATH, TEST_MALWARE_BMP_DATASET_PATH)
    # 测试模型
    test_model(RESNET_MODEL_PATH, TEST_BENIGN_BMP_DATASET_PATH, TEST_MALWARE_BMP_DATASET_PATH)
