from detector.test import test_model
from detector.train import train_model


train_benign_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_ben.bmp/train'
train_malignant_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_mal.bmp/train'
test_benign_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_ben.bmp/test'
test_malignant_path = 'D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/data/trial_mal.bmp/test'

# 黑盒检测器(128维):
# best:88%
model1_resnet18_epoch20_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/models/resnet18_epoch20_best.pth"
# best 94.7%
model2_resnet18_epoch18_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/models/resnet18_epoch18_best.pth"
# 75.5%
model3_resnet18_epoch22_path = "D:/1University/stage 3/4Software Methodology/Research/Adversarial Example Generator/detector/models/resnet18_epoch22_best.pth"

if __name__ == "__main__":
    # 训练模型:
    #train_model(model3_resnet18_epoch22_path, 22, train_benign_path, train_malignant_path, test_benign_path,test_malignant_path)
    # 测试模型
    test_model(model3_resnet18_epoch22_path, test_benign_path, test_malignant_path)
